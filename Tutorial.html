

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>FeatureHub Tutorial &mdash; FeatureHub 0.3.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="FAQ" href="faq.html" />
    <link rel="prev" title="User Guide" href="user-guide.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> FeatureHub
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="user-guide.html">User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="user-guide.html#accessing-featurehub">Accessing FeatureHub</a></li>
<li class="toctree-l2"><a class="reference internal" href="user-guide.html#accessing-featurehub-discourse-forum">Accessing FeatureHub Discourse forum</a></li>
<li class="toctree-l2"><a class="reference internal" href="user-guide.html#using-jupyter-notebook">Using Jupyter Notebook</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">FeatureHub Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Outline">Outline</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Prepare-your-session">Prepare your session</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Acquire-dataset">Acquire dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Explore-existing-features">Explore existing features</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Write-a-new-feature">Write a new feature</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Evaluate-a-feature-on-training-data">Evaluate a feature on training data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Submit-a-feature-to-Feature-database">Submit a feature to Feature database</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Final-notes">Final notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#More-feature-scaffolding">More feature scaffolding</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Don’t-use-global-variables">Don’t use global variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Use-a-helper-function-for-imports">Use a helper function for imports</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Getting-help">Getting help</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a><ul>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-restart-my-featurehub-server">How do I restart my FeatureHub server?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#why-is-my-feature-rejected-by-the-submit-function">Why is my feature rejected by the submit function?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-can-i-see-every-column-of-a-wide-dataframe">How can I see every column of a wide DataFrame?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="deployment.html">Deployment</a><ul>
<li class="toctree-l2"><a class="reference internal" href="deployment.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="deployment.html#configuration">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="deployment.html#app-deployment">App Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="deployment.html#ssl-configuration">SSL Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="deployment.html#userlist">Userlist</a></li>
<li class="toctree-l3"><a class="reference internal" href="deployment.html#jupyterhub-and-jupyter-notebook">Jupyterhub and Jupyter Notebook</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="deployment.html#data-management">Data management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="deployment.html#prediction-problem-format">Prediction problem format</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="deployment.html#user-management">User management</a></li>
<li class="toctree-l2"><a class="reference internal" href="deployment.html#app-administration">App administration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="deployment.html#hub-api-client">Hub API client</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="deployment.html#manage-app-lifecycle">Manage app lifecycle</a><ul>
<li class="toctree-l3"><a class="reference internal" href="deployment.html#restarting-the-server">Restarting the server</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="deployment.html#other-topics">Other topics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="deployment.html#local-installation">Local installation</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">FeatureHub</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>FeatureHub Tutorial</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/HDI-Project/FeatureHub/blob/master/docs/src/Tutorial.ipynb" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="FeatureHub-Tutorial">
<h1>FeatureHub Tutorial<a class="headerlink" href="#FeatureHub-Tutorial" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial, we will go through the functionality offered by
FeatureHub, a cloud platform for feature engineering.</p>
<p><em>What is feature engineering?</em> Feature engineering is the step in the
data science pipeline in which raw variables are transformed to create
features ready for inclusion in a machine learning model. This is a
critical step in a typical data science pipeline and can be one of the
most challenging aspects of a prediction task. Indeed, human intuition
and domain expertise often play a key role in the generation of
high-quality features.</p>
<div class="section" id="Outline">
<h2>Outline<a class="headerlink" href="#Outline" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="#Prepare-your-session">Getting started</a></li>
<li><a class="reference external" href="#Write-a-new-feature">Write a new feature</a></li>
<li><a class="reference external" href="#Evaluate-a-feature-on-training-data">Evaluate locally</a></li>
<li><a class="reference external" href="#Submit-a-feature-to-Feature-database">Submit to database</a></li>
<li><a class="reference external" href="#More-feature-scaffolding">More details on writing features</a></li>
<li><a class="reference external" href="#Getting-help">Getting help</a></li>
</ul>
</div>
<div class="section" id="Prepare-your-session">
<h2>Prepare your session<a class="headerlink" href="#Prepare-your-session" title="Permalink to this headline">¶</a></h2>
<p>(<a class="reference external" href="#Outline">back to top</a>)</p>
<p>We import <code class="docutils literal notranslate"><span class="pre">commands</span></code>, the FeatureHub client, into our workspace. We’ll
use this client to acquire data, evaluate our features, and register
them with the Feature database.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">featurehub.problems.demo</span> <span class="k">import</span> <span class="n">commands</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Acquire-dataset">
<h2>Acquire dataset<a class="headerlink" href="#Acquire-dataset" title="Permalink to this headline">¶</a></h2>
<p>We use <code class="docutils literal notranslate"><span class="pre">get_sample_dataset</span></code> to load the training data into our
workspace. The result is a tuple where the first element is <code class="docutils literal notranslate"><span class="pre">dataset</span></code>,
a dictionary mapping table names to Pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s, and the
second element is <code class="docutils literal notranslate"><span class="pre">target</span></code>, a Pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> with one column.
This one column is what we are trying to predict.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dataset</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">commands</span><span class="o">.</span><span class="n">get_sample_dataset</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>We can explore our data inline in the Notebook.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">list</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;users&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;groups&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">target</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Explore-existing-features">
<h2>Explore existing features<a class="headerlink" href="#Explore-existing-features" title="Permalink to this headline">¶</a></h2>
<p>We can use several methods to see what features have already been
registered to the Feature database.</p>
<p>The first method, <code class="docutils literal notranslate"><span class="pre">print_my_features</span></code>, prints the features that you
have registered to the database.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">commands</span><span class="o">.</span><span class="n">print_my_features</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>We can also pass additional parameters to <code class="docutils literal notranslate"><span class="pre">print_my_features</span></code> to
filter by code fragments or to see a certain type of metric, if
available.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">commands</span><span class="o">.</span><span class="n">print_my_features</span><span class="p">(</span><span class="n">code_fragment</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;dataset[&quot;users&quot;][&quot;name&quot;]&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>To see detailed documentation, try using Jupyter Notebook’s built-in
documentation system by appending a <code class="docutils literal notranslate"><span class="pre">?</span></code> to the end of a method name.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>commands.print_my_features<span class="o">?</span>
</pre></div>
</div>
</div>
<p>The second method, <code class="docutils literal notranslate"><span class="pre">discover_features</span></code>, prints features that other
participants have registered to the Feature database. This allows you to
discover code that has already been written, so you can either avoid
duplicating work or come up with new ideas.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">commands</span><span class="o">.</span><span class="n">discover_features</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>The same additional parameters, <code class="docutils literal notranslate"><span class="pre">code_fragment</span></code> and <code class="docutils literal notranslate"><span class="pre">metric_name</span></code>,
are available.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">commands</span><span class="o">.</span><span class="n">discover_features</span><span class="p">(</span><span class="n">code_fragment</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;fillna(&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Write-a-new-feature">
<h2>Write a new feature<a class="headerlink" href="#Write-a-new-feature" title="Permalink to this headline">¶</a></h2>
<p>(<a class="reference external" href="#Outline">back to top</a>)</p>
<p>FeatureHub asks you to observe some rudimentary scaffolding when you
write a new feature.</p>
<p>Your feature is a function that should</p>
<ul style="list-style: none;"><li><p>✓ accept a single parameter, <code class="docutils literal notranslate"><span class="pre">dataset</span></code></p>
</li><li><p>✓ return a <em>single column</em> of values</p>
<ul><li><p>that has as many rows as there are entities in the dataset</p>
</li><li><p>that is <em>ordered</em> in the same way as the entities (that is, don’t sort
your feature values!)</p>
</li><li><p>that can be coerced to a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></p>
</li></ul></li><li><p>✓ be defined in the global scope</p>
</li><li><p>✓ import all required modules that it requires within the function body</p>
</li></ul><p>Your feature should <em>not</em></p>
<ul style="list-style: none;"><li><p>✗ modify the underlying dataset</p>
</li><li><p>✗ use other variables or external module members defined at the global
scope (see below)</p>
</li></ul><p><a class="reference external" href="#More-feature-scaffolding">Skip below</a> to read more about good and
bad features in FeatureHub.</p>
<p>Here is one good example of a feature. You can execute the feature right
away to see what it returns.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">hi_lo_age</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">binarize</span>
    <span class="n">cutoff</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="k">return</span> <span class="n">binarize</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;users&quot;</span><span class="p">][</span><span class="s2">&quot;age&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">cutoff</span><span class="p">)</span>

<span class="n">hi_lo_age</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Evaluate-a-feature-on-training-data">
<h2>Evaluate a feature on training data<a class="headerlink" href="#Evaluate-a-feature-on-training-data" title="Permalink to this headline">¶</a></h2>
<p>(<a class="reference external" href="#Outline">back to top</a>)</p>
<p>Now that we have written a candidate feature, we can evaluate it on
training data. The evaluation routine proceeds as follows.</p>
<ol class="arabic simple">
<li>Obtains a valid dataset. That is, if the <code class="docutils literal notranslate"><span class="pre">dataset</span></code> has been
modified, it is reloaded.</li>
<li>Extracts features. That is, your function is called with the dataset
as its parameter, returning a column of values.</li>
<li>Verifies the integrity of the dataset, in that it was not changed by
executing the feature.</li>
<li>Validates feature values, to ensure they meet the requirements listed
above.</li>
<li>Builds full feature matrix, by combining extracted feature values
with pre-processed entity features.</li>
<li>Fits model and computes metrics. Given the task (classification,
regression, etc.), a model is chosen and fit given the full feature
matrix. Then, appropriate metrics are computed via cross-validation
and displayed.</li>
</ol>
<p>In your workflow, you may run the <code class="docutils literal notranslate"><span class="pre">evaluate</span></code> function several times.
At first, it may reveal bugs or syntax errors that you will fix. Next,
it may reveal that your feature did not meet some of the FeatureHub
requirements, such as returning a single column of values or using
function-scope imports. Finally, you may find that your feature’s
performance, in terms of metrics like classification accuracy or mean
squared error, are not as good as you hoped, and you may modify it or
jettison it altogether.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">evaluate</span></code> function takes a single argument: the candidate
feature.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">commands</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">hi_lo_age</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Submit-a-feature-to-Feature-database">
<h2>Submit a feature to Feature database<a class="headerlink" href="#Submit-a-feature-to-Feature-database" title="Permalink to this headline">¶</a></h2>
<p>(<a class="reference external" href="#Outline">back to top</a>)</p>
<p>Now that you have evaluated your feature locally on training data, and
are happy with its performance, you can submit it to the Feature
Evaluation Server. The evaluation server will essentially repeat the
steps in <code class="docutils literal notranslate"><span class="pre">evaluate</span></code>, with some slight changes. For example, it fits
the model on the training dataset and evaluates it on the <em>test
dataset</em>, without performing cross-validation.</p>
<p>During submission, you are asked to write a natural language description
(in English) of your feature. Imagine that you are explaining your code
to a non-technical colleague. This description should be - <em>clear</em> -
<em>concise</em> - <em>informative</em> to a domain expert who is not a data scientist
- <em>accurate</em> (in that your description matches what the code actually
does)</p>
<p>You will be prompted to type in a description to a textbox input.
Alternately, you can pass a string using the keyword argument
<code class="docutils literal notranslate"><span class="pre">description</span></code>.</p>
<p>If there are no issues, the feature and its associated performance
metrics are added to the Feature database (“registered”).</p>
<p>The feature may also be posted automatically to the FeatureHub forum
(not applicable for this Tutorial). A link will be printed, and you can
navigate directly to your post to join the conversation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">commands</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">hi_lo_age</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Final-notes">
<h2>Final notes<a class="headerlink" href="#Final-notes" title="Permalink to this headline">¶</a></h2>
<p>As briefly mentioned in the section on feature evaluation, FeatureHub
may combine your feature values with preproccessed entity-level
features, if applicable to the problem. Problem descriptions will
describe the transformations done during preprocessing. You can also
inspect the entity-level features directly.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">entity_features</span> <span class="o">=</span> <span class="n">commands</span><span class="o">.</span><span class="n">get_entity_features</span><span class="p">()</span>
<span class="n">entity_features</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="More-feature-scaffolding">
<h2>More feature scaffolding<a class="headerlink" href="#More-feature-scaffolding" title="Permalink to this headline">¶</a></h2>
<p>(<a class="reference external" href="#Outline">back to top</a>) (<a class="reference external" href="#Write-a-new-feature">back to writing
features</a>)</p>
<p>Let’s take a closer look at how good and bad features are written in
FeatureHub. Here, we are just talking about the <em>scaffolding</em> of the
feature, and not whether the feature has predictive power in a machine
learning model or any semantic meaning.</p>
<p>Here are some examples of good and bad features, with explanations:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># good - one parameter, imports numpy within function scope,</span>
<span class="c1">#        returns column of values of the right shape.</span>
<span class="k">def</span> <span class="nf">all_zeros</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">zeros</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;users&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

<span class="c1"># bad - wrong number of parameters</span>
<span class="k">def</span> <span class="nf">two_parameters</span><span class="p">(</span><span class="n">users</span><span class="p">,</span> <span class="n">groups</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">users</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">]</span>

<span class="c1"># bad - return value cannot be coerced to DataFrame</span>
<span class="k">def</span> <span class="nf">scalar_zero</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">0</span>

<span class="c1"># bad - return value is not correct shape</span>
<span class="k">def</span> <span class="nf">row_of_zeros</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">zeros</span>
    <span class="k">return</span> <span class="n">zeros</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>

<span class="c1"># bad - modifies underlying dataset!</span>
<span class="k">def</span> <span class="nf">modify_dataset</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
    <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;users&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="bp">None</span>
</pre></div>
</div>
<div class="section" id="Don’t-use-global-variables">
<h3>Don’t use global variables<a class="headerlink" href="#Don’t-use-global-variables" title="Permalink to this headline">¶</a></h3>
<p>Your feature will be evaluated by FeatureHub in an isolated namespace.
This means that your feature cannot expect variables or modules that you
have defined at the global scope to exist. By “global scope”, we mean
variables or modules that are defined outside of your function
definition.</p>
<p>Similarly, <em>all module imports should be done within your function</em>. In
the next section, we’ll demonstrate an easy-to-use workflow that gets
around this limitation.</p>
<p>This feature is <em>invalid</em>, because it uses a variable, <code class="docutils literal notranslate"><span class="pre">cutoff</span></code>,
defined at the global scope (outside of the function definition):</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># bad</span>
<span class="n">cutoff</span> <span class="o">=</span> <span class="mi">30</span>
<span class="k">def</span> <span class="nf">hi_lo_age</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">binarize</span>
    <span class="k">return</span> <span class="n">binarize</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;users&quot;</span><span class="p">][</span><span class="s2">&quot;age&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">cutoff</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This feature is okay, because it moves the variable into the function
definition:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># better</span>
<span class="k">def</span> <span class="nf">hi_lo_age</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">binarize</span>
    <span class="n">cutoff</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="k">return</span> <span class="n">binarize</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;users&quot;</span><span class="p">][</span><span class="s2">&quot;age&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">cutoff</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>One exception to this requirement is that you can use helper <em>functions</em>
that you define at the global scope:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">first_name_is_longer</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="n">first</span><span class="p">,</span> <span class="n">last</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">first</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">last</span><span class="p">)</span>

<span class="c1"># okay</span>
<span class="k">def</span> <span class="nf">long_first_name</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;users&quot;</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">first_name_is_longer</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Use-a-helper-function-for-imports">
<h3>Use a helper function for imports<a class="headerlink" href="#Use-a-helper-function-for-imports" title="Permalink to this headline">¶</a></h3>
<p>You might want to import the same set of modules in many different
features without re-typing them. You can use a helper function to import
them, while still avoiding using global variables.</p>
<p>In the following example, we define a function <code class="docutils literal notranslate"><span class="pre">imports</span></code> that declares
<code class="docutils literal notranslate"><span class="pre">pd</span></code> and <code class="docutils literal notranslate"><span class="pre">np</span></code> as global variables and then imports the corresponding
libraries. This function can then be called in any feature to make those
libraries available.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">imports</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">pd</span><span class="p">,</span> <span class="n">np</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">age_with_random_noise</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
    <span class="n">imports</span><span class="p">()</span>

    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;users&quot;</span><span class="p">])</span>
    <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;users&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">noise</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Getting-help">
<h2>Getting help<a class="headerlink" href="#Getting-help" title="Permalink to this headline">¶</a></h2>
<p>(<a class="reference external" href="#Outline">back to top</a>)</p>
<p>If you need further help, there are several resources available.</p>
<ul class="simple">
<li>Check out the FeatureHub <a class="reference external" href="https://hdi-project.github.io/FeatureHub/user-guide.html">User
Guide</a></li>
<li>Check out the FeatureHub
<a class="reference external" href="https://hdi-project.github.io/FeatureHub/faq.html">FAQ</a></li>
<li>Ask for help on the FeatureHub
<a class="reference external" href="https://discourse.featurehub.net">forum</a></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="faq.html" class="btn btn-neutral float-right" title="FAQ" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="user-guide.html" class="btn btn-neutral" title="User Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Micah Smith

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>